Function Get-MsrcCvrfExploitabilityIndex {
<#
    .SYNOPSIS
        Get the exploitability index of vulnerabilities found in CVRF document

    .DESCRIPTION
       This function gathers the Exploitability Index from vulnerabilities in a CVRF document.

    .PARAMETER Vulnerability
        A vulnerability object or objects from a CVRF document object

    .EXAMPLE
        Get-MsrcCvrfDocument -ID 2016-Nov | Get-MsrcCvrfExploitabilityIndex

        Get the exploitability index from a CVRF document using the pipeline.

    .EXAMPLE
        $cvrfDocument = Get-MsrcCvrfDocument -ID 2016-Nov
        Get-MsrcCvrfExploitabilityIndex -Vulnerability $cvrfDocument.Vulnerability

        Get the exploitability index from a CVRF document using a variable and parameters
#>
[CmdletBinding()]
Param (
    [Parameter(Mandatory,ValueFromPipelineByPropertyName)]
    $Vulnerability
)
Begin {}
Process {
    $Vulnerability | ForEach-Object {
        $v = $_

        $v.Threats |
        Where-Object { $_.Type -EQ 1 } |
        ForEach-Object {

            $es = Get-MsrcThreatExploitStatus -ExploitStatusString $_.Description.Value
            [PSCustomObject]@{
                CVE = $v.CVE
                Title = $v.Title.Value
                PubliclyDisclosed     = $es.PubliclyDisclosed
                Exploited             = $es.Exploited
                LatestSoftwareRelease = $es.LatestSoftwareRelease
                OlderSoftwareRelease  = $es.OlderSoftwareRelease
            }
        }
    }
}
End {}
}